{"ast":null,"code":"import { toArray, createNamespace, isFunction } from \"../utils/index.mjs\";\nconst [name, bem, t] = createNamespace(\"uploader\");\n\nfunction readFileContent(file, resultType) {\n  return new Promise(resolve => {\n    if (resultType === \"file\") {\n      resolve();\n      return;\n    }\n\n    const reader = new FileReader();\n\n    reader.onload = event => {\n      resolve(event.target.result);\n    };\n\n    if (resultType === \"dataUrl\") {\n      reader.readAsDataURL(file);\n    } else if (resultType === \"text\") {\n      reader.readAsText(file);\n    }\n  });\n}\n\nfunction isOversize(items, maxSize) {\n  return toArray(items).some(item => {\n    if (item.file) {\n      if (isFunction(maxSize)) {\n        return maxSize(item.file);\n      }\n\n      return item.file.size > maxSize;\n    }\n\n    return false;\n  });\n}\n\nfunction filterFiles(items, maxSize) {\n  const valid = [];\n  const invalid = [];\n  items.forEach(item => {\n    if (isOversize(item, maxSize)) {\n      invalid.push(item);\n    } else {\n      valid.push(item);\n    }\n  });\n  return {\n    valid,\n    invalid\n  };\n}\n\nconst IMAGE_REGEXP = /\\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)/i;\n\nconst isImageUrl = url => IMAGE_REGEXP.test(url);\n\nfunction isImageFile(item) {\n  if (item.isImage) {\n    return true;\n  }\n\n  if (item.file && item.file.type) {\n    return item.file.type.indexOf(\"image\") === 0;\n  }\n\n  if (item.url) {\n    return isImageUrl(item.url);\n  }\n\n  if (typeof item.content === \"string\") {\n    return item.content.indexOf(\"data:image\") === 0;\n  }\n\n  return false;\n}\n\nexport { bem, filterFiles, isImageFile, isImageUrl, isOversize, name, readFileContent, t };","map":{"version":3,"names":["toArray","createNamespace","isFunction","name","bem","t","readFileContent","file","resultType","Promise","resolve","reader","FileReader","onload","event","target","result","readAsDataURL","readAsText","isOversize","items","maxSize","some","item","size","filterFiles","valid","invalid","forEach","push","IMAGE_REGEXP","isImageUrl","url","test","isImageFile","isImage","type","indexOf","content"],"sources":["D:/web/my-blog/node_modules/vant/es/uploader/utils.mjs"],"sourcesContent":["import { toArray, createNamespace, isFunction } from \"../utils/index.mjs\";\nconst [name, bem, t] = createNamespace(\"uploader\");\nfunction readFileContent(file, resultType) {\n  return new Promise((resolve) => {\n    if (resultType === \"file\") {\n      resolve();\n      return;\n    }\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      resolve(event.target.result);\n    };\n    if (resultType === \"dataUrl\") {\n      reader.readAsDataURL(file);\n    } else if (resultType === \"text\") {\n      reader.readAsText(file);\n    }\n  });\n}\nfunction isOversize(items, maxSize) {\n  return toArray(items).some((item) => {\n    if (item.file) {\n      if (isFunction(maxSize)) {\n        return maxSize(item.file);\n      }\n      return item.file.size > maxSize;\n    }\n    return false;\n  });\n}\nfunction filterFiles(items, maxSize) {\n  const valid = [];\n  const invalid = [];\n  items.forEach((item) => {\n    if (isOversize(item, maxSize)) {\n      invalid.push(item);\n    } else {\n      valid.push(item);\n    }\n  });\n  return { valid, invalid };\n}\nconst IMAGE_REGEXP = /\\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)/i;\nconst isImageUrl = (url) => IMAGE_REGEXP.test(url);\nfunction isImageFile(item) {\n  if (item.isImage) {\n    return true;\n  }\n  if (item.file && item.file.type) {\n    return item.file.type.indexOf(\"image\") === 0;\n  }\n  if (item.url) {\n    return isImageUrl(item.url);\n  }\n  if (typeof item.content === \"string\") {\n    return item.content.indexOf(\"data:image\") === 0;\n  }\n  return false;\n}\nexport {\n  bem,\n  filterFiles,\n  isImageFile,\n  isImageUrl,\n  isOversize,\n  name,\n  readFileContent,\n  t\n};\n"],"mappings":"AAAA,SAASA,OAAT,EAAkBC,eAAlB,EAAmCC,UAAnC,QAAqD,oBAArD;AACA,MAAM,CAACC,IAAD,EAAOC,GAAP,EAAYC,CAAZ,IAAiBJ,eAAe,CAAC,UAAD,CAAtC;;AACA,SAASK,eAAT,CAAyBC,IAAzB,EAA+BC,UAA/B,EAA2C;EACzC,OAAO,IAAIC,OAAJ,CAAaC,OAAD,IAAa;IAC9B,IAAIF,UAAU,KAAK,MAAnB,EAA2B;MACzBE,OAAO;MACP;IACD;;IACD,MAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;;IACAD,MAAM,CAACE,MAAP,GAAiBC,KAAD,IAAW;MACzBJ,OAAO,CAACI,KAAK,CAACC,MAAN,CAAaC,MAAd,CAAP;IACD,CAFD;;IAGA,IAAIR,UAAU,KAAK,SAAnB,EAA8B;MAC5BG,MAAM,CAACM,aAAP,CAAqBV,IAArB;IACD,CAFD,MAEO,IAAIC,UAAU,KAAK,MAAnB,EAA2B;MAChCG,MAAM,CAACO,UAAP,CAAkBX,IAAlB;IACD;EACF,CAdM,CAAP;AAeD;;AACD,SAASY,UAAT,CAAoBC,KAApB,EAA2BC,OAA3B,EAAoC;EAClC,OAAOrB,OAAO,CAACoB,KAAD,CAAP,CAAeE,IAAf,CAAqBC,IAAD,IAAU;IACnC,IAAIA,IAAI,CAAChB,IAAT,EAAe;MACb,IAAIL,UAAU,CAACmB,OAAD,CAAd,EAAyB;QACvB,OAAOA,OAAO,CAACE,IAAI,CAAChB,IAAN,CAAd;MACD;;MACD,OAAOgB,IAAI,CAAChB,IAAL,CAAUiB,IAAV,GAAiBH,OAAxB;IACD;;IACD,OAAO,KAAP;EACD,CARM,CAAP;AASD;;AACD,SAASI,WAAT,CAAqBL,KAArB,EAA4BC,OAA5B,EAAqC;EACnC,MAAMK,KAAK,GAAG,EAAd;EACA,MAAMC,OAAO,GAAG,EAAhB;EACAP,KAAK,CAACQ,OAAN,CAAeL,IAAD,IAAU;IACtB,IAAIJ,UAAU,CAACI,IAAD,EAAOF,OAAP,CAAd,EAA+B;MAC7BM,OAAO,CAACE,IAAR,CAAaN,IAAb;IACD,CAFD,MAEO;MACLG,KAAK,CAACG,IAAN,CAAWN,IAAX;IACD;EACF,CAND;EAOA,OAAO;IAAEG,KAAF;IAASC;EAAT,CAAP;AACD;;AACD,MAAMG,YAAY,GAAG,6CAArB;;AACA,MAAMC,UAAU,GAAIC,GAAD,IAASF,YAAY,CAACG,IAAb,CAAkBD,GAAlB,CAA5B;;AACA,SAASE,WAAT,CAAqBX,IAArB,EAA2B;EACzB,IAAIA,IAAI,CAACY,OAAT,EAAkB;IAChB,OAAO,IAAP;EACD;;EACD,IAAIZ,IAAI,CAAChB,IAAL,IAAagB,IAAI,CAAChB,IAAL,CAAU6B,IAA3B,EAAiC;IAC/B,OAAOb,IAAI,CAAChB,IAAL,CAAU6B,IAAV,CAAeC,OAAf,CAAuB,OAAvB,MAAoC,CAA3C;EACD;;EACD,IAAId,IAAI,CAACS,GAAT,EAAc;IACZ,OAAOD,UAAU,CAACR,IAAI,CAACS,GAAN,CAAjB;EACD;;EACD,IAAI,OAAOT,IAAI,CAACe,OAAZ,KAAwB,QAA5B,EAAsC;IACpC,OAAOf,IAAI,CAACe,OAAL,CAAaD,OAAb,CAAqB,YAArB,MAAuC,CAA9C;EACD;;EACD,OAAO,KAAP;AACD;;AACD,SACEjC,GADF,EAEEqB,WAFF,EAGES,WAHF,EAIEH,UAJF,EAKEZ,UALF,EAMEhB,IANF,EAOEG,eAPF,EAQED,CARF"},"metadata":{},"sourceType":"module"}