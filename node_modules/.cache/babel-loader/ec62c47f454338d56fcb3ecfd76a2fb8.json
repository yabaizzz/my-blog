{"ast":null,"code":"import { createVNode as _createVNode } from \"vue\";\nimport { ref, watch, nextTick, onUpdated, onMounted, defineComponent } from \"vue\";\nimport { isHidden, truthProp, makeStringProp, makeNumericProp, createNamespace } from \"../utils/index.mjs\";\nimport { useRect, useScrollParent, useEventListener } from \"@vant/use\";\nimport { useExpose } from \"../composables/use-expose.mjs\";\nimport { useTabStatus } from \"../composables/use-tab-status.mjs\";\nimport { Loading } from \"../loading/index.mjs\";\nconst [name, bem, t] = createNamespace(\"list\");\nconst listProps = {\n  error: Boolean,\n  offset: makeNumericProp(300),\n  loading: Boolean,\n  finished: Boolean,\n  errorText: String,\n  direction: makeStringProp(\"down\"),\n  loadingText: String,\n  finishedText: String,\n  immediateCheck: truthProp\n};\nvar stdin_default = defineComponent({\n  name,\n  props: listProps,\n  emits: [\"load\", \"update:error\", \"update:loading\"],\n\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const loading = ref(false);\n    const root = ref();\n    const placeholder = ref();\n    const tabStatus = useTabStatus();\n    const scrollParent = useScrollParent(root);\n\n    const check = () => {\n      nextTick(() => {\n        if (loading.value || props.finished || props.error || (tabStatus == null ? void 0 : tabStatus.value) === false) {\n          return;\n        }\n\n        const {\n          offset,\n          direction\n        } = props;\n        const scrollParentRect = useRect(scrollParent);\n\n        if (!scrollParentRect.height || isHidden(root)) {\n          return;\n        }\n\n        let isReachEdge = false;\n        const placeholderRect = useRect(placeholder);\n\n        if (direction === \"up\") {\n          isReachEdge = scrollParentRect.top - placeholderRect.top <= offset;\n        } else {\n          isReachEdge = placeholderRect.bottom - scrollParentRect.bottom <= offset;\n        }\n\n        if (isReachEdge) {\n          loading.value = true;\n          emit(\"update:loading\", true);\n          emit(\"load\");\n        }\n      });\n    };\n\n    const renderFinishedText = () => {\n      if (props.finished) {\n        const text = slots.finished ? slots.finished() : props.finishedText;\n\n        if (text) {\n          return _createVNode(\"div\", {\n            \"class\": bem(\"finished-text\")\n          }, [text]);\n        }\n      }\n    };\n\n    const clickErrorText = () => {\n      emit(\"update:error\", false);\n      check();\n    };\n\n    const renderErrorText = () => {\n      if (props.error) {\n        const text = slots.error ? slots.error() : props.errorText;\n\n        if (text) {\n          return _createVNode(\"div\", {\n            \"role\": \"button\",\n            \"class\": bem(\"error-text\"),\n            \"tabindex\": 0,\n            \"onClick\": clickErrorText\n          }, [text]);\n        }\n      }\n    };\n\n    const renderLoading = () => {\n      if (loading.value && !props.finished) {\n        return _createVNode(\"div\", {\n          \"class\": bem(\"loading\")\n        }, [slots.loading ? slots.loading() : _createVNode(Loading, {\n          \"class\": bem(\"loading-icon\")\n        }, {\n          default: () => [props.loadingText || t(\"loading\")]\n        })]);\n      }\n    };\n\n    watch(() => [props.loading, props.finished, props.error], check);\n\n    if (tabStatus) {\n      watch(tabStatus, tabActive => {\n        if (tabActive) {\n          check();\n        }\n      });\n    }\n\n    onUpdated(() => {\n      loading.value = props.loading;\n    });\n    onMounted(() => {\n      if (props.immediateCheck) {\n        check();\n      }\n    });\n    useExpose({\n      check\n    });\n    useEventListener(\"scroll\", check, {\n      target: scrollParent\n    });\n    return () => {\n      var _a;\n\n      const Content = (_a = slots.default) == null ? void 0 : _a.call(slots);\n\n      const Placeholder = _createVNode(\"div\", {\n        \"ref\": placeholder,\n        \"class\": bem(\"placeholder\")\n      }, null);\n\n      return _createVNode(\"div\", {\n        \"ref\": root,\n        \"role\": \"feed\",\n        \"class\": bem(),\n        \"aria-busy\": loading.value\n      }, [props.direction === \"down\" ? Content : Placeholder, renderLoading(), renderFinishedText(), renderErrorText(), props.direction === \"up\" ? Content : Placeholder]);\n    };\n  }\n\n});\nexport { stdin_default as default };","map":{"version":3,"names":["createVNode","_createVNode","ref","watch","nextTick","onUpdated","onMounted","defineComponent","isHidden","truthProp","makeStringProp","makeNumericProp","createNamespace","useRect","useScrollParent","useEventListener","useExpose","useTabStatus","Loading","name","bem","t","listProps","error","Boolean","offset","loading","finished","errorText","String","direction","loadingText","finishedText","immediateCheck","stdin_default","props","emits","setup","emit","slots","root","placeholder","tabStatus","scrollParent","check","value","scrollParentRect","height","isReachEdge","placeholderRect","top","bottom","renderFinishedText","text","clickErrorText","renderErrorText","renderLoading","default","tabActive","target","_a","Content","call","Placeholder"],"sources":["D:/项目/my-blog/node_modules/vant/es/list/List.mjs"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { ref, watch, nextTick, onUpdated, onMounted, defineComponent } from \"vue\";\nimport { isHidden, truthProp, makeStringProp, makeNumericProp, createNamespace } from \"../utils/index.mjs\";\nimport { useRect, useScrollParent, useEventListener } from \"@vant/use\";\nimport { useExpose } from \"../composables/use-expose.mjs\";\nimport { useTabStatus } from \"../composables/use-tab-status.mjs\";\nimport { Loading } from \"../loading/index.mjs\";\nconst [name, bem, t] = createNamespace(\"list\");\nconst listProps = {\n  error: Boolean,\n  offset: makeNumericProp(300),\n  loading: Boolean,\n  finished: Boolean,\n  errorText: String,\n  direction: makeStringProp(\"down\"),\n  loadingText: String,\n  finishedText: String,\n  immediateCheck: truthProp\n};\nvar stdin_default = defineComponent({\n  name,\n  props: listProps,\n  emits: [\"load\", \"update:error\", \"update:loading\"],\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const loading = ref(false);\n    const root = ref();\n    const placeholder = ref();\n    const tabStatus = useTabStatus();\n    const scrollParent = useScrollParent(root);\n    const check = () => {\n      nextTick(() => {\n        if (loading.value || props.finished || props.error || (tabStatus == null ? void 0 : tabStatus.value) === false) {\n          return;\n        }\n        const {\n          offset,\n          direction\n        } = props;\n        const scrollParentRect = useRect(scrollParent);\n        if (!scrollParentRect.height || isHidden(root)) {\n          return;\n        }\n        let isReachEdge = false;\n        const placeholderRect = useRect(placeholder);\n        if (direction === \"up\") {\n          isReachEdge = scrollParentRect.top - placeholderRect.top <= offset;\n        } else {\n          isReachEdge = placeholderRect.bottom - scrollParentRect.bottom <= offset;\n        }\n        if (isReachEdge) {\n          loading.value = true;\n          emit(\"update:loading\", true);\n          emit(\"load\");\n        }\n      });\n    };\n    const renderFinishedText = () => {\n      if (props.finished) {\n        const text = slots.finished ? slots.finished() : props.finishedText;\n        if (text) {\n          return _createVNode(\"div\", {\n            \"class\": bem(\"finished-text\")\n          }, [text]);\n        }\n      }\n    };\n    const clickErrorText = () => {\n      emit(\"update:error\", false);\n      check();\n    };\n    const renderErrorText = () => {\n      if (props.error) {\n        const text = slots.error ? slots.error() : props.errorText;\n        if (text) {\n          return _createVNode(\"div\", {\n            \"role\": \"button\",\n            \"class\": bem(\"error-text\"),\n            \"tabindex\": 0,\n            \"onClick\": clickErrorText\n          }, [text]);\n        }\n      }\n    };\n    const renderLoading = () => {\n      if (loading.value && !props.finished) {\n        return _createVNode(\"div\", {\n          \"class\": bem(\"loading\")\n        }, [slots.loading ? slots.loading() : _createVNode(Loading, {\n          \"class\": bem(\"loading-icon\")\n        }, {\n          default: () => [props.loadingText || t(\"loading\")]\n        })]);\n      }\n    };\n    watch(() => [props.loading, props.finished, props.error], check);\n    if (tabStatus) {\n      watch(tabStatus, (tabActive) => {\n        if (tabActive) {\n          check();\n        }\n      });\n    }\n    onUpdated(() => {\n      loading.value = props.loading;\n    });\n    onMounted(() => {\n      if (props.immediateCheck) {\n        check();\n      }\n    });\n    useExpose({\n      check\n    });\n    useEventListener(\"scroll\", check, {\n      target: scrollParent\n    });\n    return () => {\n      var _a;\n      const Content = (_a = slots.default) == null ? void 0 : _a.call(slots);\n      const Placeholder = _createVNode(\"div\", {\n        \"ref\": placeholder,\n        \"class\": bem(\"placeholder\")\n      }, null);\n      return _createVNode(\"div\", {\n        \"ref\": root,\n        \"role\": \"feed\",\n        \"class\": bem(),\n        \"aria-busy\": loading.value\n      }, [props.direction === \"down\" ? Content : Placeholder, renderLoading(), renderFinishedText(), renderErrorText(), props.direction === \"up\" ? Content : Placeholder]);\n    };\n  }\n});\nexport {\n  stdin_default as default\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}