{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { inBrowser } from \"@vant/use\";\nconst hasIntersectionObserver = inBrowser && \"IntersectionObserver\" in window && \"IntersectionObserverEntry\" in window && \"intersectionRatio\" in window.IntersectionObserverEntry.prototype;\nconst modeType = {\n  event: \"event\",\n  observer: \"observer\"\n};\n\nfunction remove(arr, item) {\n  if (!arr.length) return;\n  const index = arr.indexOf(item);\n  if (index > -1) return arr.splice(index, 1);\n}\n\nfunction getBestSelectionFromSrcset(el, scale) {\n  if (el.tagName !== \"IMG\" || !el.getAttribute(\"data-srcset\")) return;\n  let options = el.getAttribute(\"data-srcset\");\n  const container = el.parentNode;\n  const containerWidth = container.offsetWidth * scale;\n  let spaceIndex;\n  let tmpSrc;\n  let tmpWidth;\n  options = options.trim().split(\",\");\n  const result = options.map(item => {\n    item = item.trim();\n    spaceIndex = item.lastIndexOf(\" \");\n\n    if (spaceIndex === -1) {\n      tmpSrc = item;\n      tmpWidth = 999998;\n    } else {\n      tmpSrc = item.substr(0, spaceIndex);\n      tmpWidth = parseInt(item.substr(spaceIndex + 1, item.length - spaceIndex - 2), 10);\n    }\n\n    return [tmpWidth, tmpSrc];\n  });\n  result.sort((a, b) => {\n    if (a[0] < b[0]) {\n      return 1;\n    }\n\n    if (a[0] > b[0]) {\n      return -1;\n    }\n\n    if (a[0] === b[0]) {\n      if (b[1].indexOf(\".webp\", b[1].length - 5) !== -1) {\n        return 1;\n      }\n\n      if (a[1].indexOf(\".webp\", a[1].length - 5) !== -1) {\n        return -1;\n      }\n    }\n\n    return 0;\n  });\n  let bestSelectedSrc = \"\";\n  let tmpOption;\n\n  for (let i = 0; i < result.length; i++) {\n    tmpOption = result[i];\n    bestSelectedSrc = tmpOption[1];\n    const next = result[i + 1];\n\n    if (next && next[0] < containerWidth) {\n      bestSelectedSrc = tmpOption[1];\n      break;\n    } else if (!next) {\n      bestSelectedSrc = tmpOption[1];\n      break;\n    }\n  }\n\n  return bestSelectedSrc;\n}\n\nconst getDPR = (scale = 1) => inBrowser ? window.devicePixelRatio || scale : scale;\n\nfunction supportWebp() {\n  if (!inBrowser) return false;\n  let support = true;\n\n  try {\n    const elem = document.createElement(\"canvas\");\n\n    if (elem.getContext && elem.getContext(\"2d\")) {\n      support = elem.toDataURL(\"image/webp\").indexOf(\"data:image/webp\") === 0;\n    }\n  } catch (err) {\n    support = false;\n  }\n\n  return support;\n}\n\nfunction throttle(action, delay) {\n  let timeout = null;\n  let lastRun = 0;\n  return function (...args) {\n    if (timeout) {\n      return;\n    }\n\n    const elapsed = Date.now() - lastRun;\n\n    const runCallback = () => {\n      lastRun = Date.now();\n      timeout = false;\n      action.apply(this, args);\n    };\n\n    if (elapsed >= delay) {\n      runCallback();\n    } else {\n      timeout = setTimeout(runCallback, delay);\n    }\n  };\n}\n\nfunction on(el, type, func) {\n  el.addEventListener(type, func, {\n    capture: false,\n    passive: true\n  });\n}\n\nfunction off(el, type, func) {\n  el.removeEventListener(type, func, false);\n}\n\nconst loadImageAsync = (item, resolve, reject) => {\n  const image = new Image();\n\n  if (!item || !item.src) {\n    return reject(new Error(\"image src is required\"));\n  }\n\n  image.src = item.src;\n\n  if (item.cors) {\n    image.crossOrigin = item.cors;\n  }\n\n  image.onload = () => resolve({\n    naturalHeight: image.naturalHeight,\n    naturalWidth: image.naturalWidth,\n    src: image.src\n  });\n\n  image.onerror = e => reject(e);\n};\n\nclass ImageCache {\n  constructor({\n    max\n  }) {\n    this.options = {\n      max: max || 100\n    };\n    this.caches = [];\n  }\n\n  has(key) {\n    return this.caches.indexOf(key) > -1;\n  }\n\n  add(key) {\n    if (this.has(key)) return;\n    this.caches.push(key);\n\n    if (this.caches.length > this.options.max) {\n      this.free();\n    }\n  }\n\n  free() {\n    this.caches.shift();\n  }\n\n}\n\nexport { ImageCache, getBestSelectionFromSrcset, getDPR, hasIntersectionObserver, loadImageAsync, modeType, off, on, remove, supportWebp, throttle };","map":{"version":3,"names":["inBrowser","hasIntersectionObserver","window","IntersectionObserverEntry","prototype","modeType","event","observer","remove","arr","item","length","index","indexOf","splice","getBestSelectionFromSrcset","el","scale","tagName","getAttribute","options","container","parentNode","containerWidth","offsetWidth","spaceIndex","tmpSrc","tmpWidth","trim","split","result","map","lastIndexOf","substr","parseInt","sort","a","b","bestSelectedSrc","tmpOption","i","next","getDPR","devicePixelRatio","supportWebp","support","elem","document","createElement","getContext","toDataURL","err","throttle","action","delay","timeout","lastRun","args","elapsed","Date","now","runCallback","apply","setTimeout","on","type","func","addEventListener","capture","passive","off","removeEventListener","loadImageAsync","resolve","reject","image","Image","src","Error","cors","crossOrigin","onload","naturalHeight","naturalWidth","onerror","e","ImageCache","constructor","max","caches","has","key","add","push","free","shift"],"sources":["D:/项目/my-blog/node_modules/vant/es/lazyload/vue-lazyload/util.mjs"],"sourcesContent":["import { inBrowser } from \"@vant/use\";\nconst hasIntersectionObserver = inBrowser && \"IntersectionObserver\" in window && \"IntersectionObserverEntry\" in window && \"intersectionRatio\" in window.IntersectionObserverEntry.prototype;\nconst modeType = {\n  event: \"event\",\n  observer: \"observer\"\n};\nfunction remove(arr, item) {\n  if (!arr.length)\n    return;\n  const index = arr.indexOf(item);\n  if (index > -1)\n    return arr.splice(index, 1);\n}\nfunction getBestSelectionFromSrcset(el, scale) {\n  if (el.tagName !== \"IMG\" || !el.getAttribute(\"data-srcset\"))\n    return;\n  let options = el.getAttribute(\"data-srcset\");\n  const container = el.parentNode;\n  const containerWidth = container.offsetWidth * scale;\n  let spaceIndex;\n  let tmpSrc;\n  let tmpWidth;\n  options = options.trim().split(\",\");\n  const result = options.map((item) => {\n    item = item.trim();\n    spaceIndex = item.lastIndexOf(\" \");\n    if (spaceIndex === -1) {\n      tmpSrc = item;\n      tmpWidth = 999998;\n    } else {\n      tmpSrc = item.substr(0, spaceIndex);\n      tmpWidth = parseInt(item.substr(spaceIndex + 1, item.length - spaceIndex - 2), 10);\n    }\n    return [tmpWidth, tmpSrc];\n  });\n  result.sort((a, b) => {\n    if (a[0] < b[0]) {\n      return 1;\n    }\n    if (a[0] > b[0]) {\n      return -1;\n    }\n    if (a[0] === b[0]) {\n      if (b[1].indexOf(\".webp\", b[1].length - 5) !== -1) {\n        return 1;\n      }\n      if (a[1].indexOf(\".webp\", a[1].length - 5) !== -1) {\n        return -1;\n      }\n    }\n    return 0;\n  });\n  let bestSelectedSrc = \"\";\n  let tmpOption;\n  for (let i = 0; i < result.length; i++) {\n    tmpOption = result[i];\n    bestSelectedSrc = tmpOption[1];\n    const next = result[i + 1];\n    if (next && next[0] < containerWidth) {\n      bestSelectedSrc = tmpOption[1];\n      break;\n    } else if (!next) {\n      bestSelectedSrc = tmpOption[1];\n      break;\n    }\n  }\n  return bestSelectedSrc;\n}\nconst getDPR = (scale = 1) => inBrowser ? window.devicePixelRatio || scale : scale;\nfunction supportWebp() {\n  if (!inBrowser)\n    return false;\n  let support = true;\n  try {\n    const elem = document.createElement(\"canvas\");\n    if (elem.getContext && elem.getContext(\"2d\")) {\n      support = elem.toDataURL(\"image/webp\").indexOf(\"data:image/webp\") === 0;\n    }\n  } catch (err) {\n    support = false;\n  }\n  return support;\n}\nfunction throttle(action, delay) {\n  let timeout = null;\n  let lastRun = 0;\n  return function(...args) {\n    if (timeout) {\n      return;\n    }\n    const elapsed = Date.now() - lastRun;\n    const runCallback = () => {\n      lastRun = Date.now();\n      timeout = false;\n      action.apply(this, args);\n    };\n    if (elapsed >= delay) {\n      runCallback();\n    } else {\n      timeout = setTimeout(runCallback, delay);\n    }\n  };\n}\nfunction on(el, type, func) {\n  el.addEventListener(type, func, {\n    capture: false,\n    passive: true\n  });\n}\nfunction off(el, type, func) {\n  el.removeEventListener(type, func, false);\n}\nconst loadImageAsync = (item, resolve, reject) => {\n  const image = new Image();\n  if (!item || !item.src) {\n    return reject(new Error(\"image src is required\"));\n  }\n  image.src = item.src;\n  if (item.cors) {\n    image.crossOrigin = item.cors;\n  }\n  image.onload = () => resolve({\n    naturalHeight: image.naturalHeight,\n    naturalWidth: image.naturalWidth,\n    src: image.src\n  });\n  image.onerror = (e) => reject(e);\n};\nclass ImageCache {\n  constructor({ max }) {\n    this.options = {\n      max: max || 100\n    };\n    this.caches = [];\n  }\n  has(key) {\n    return this.caches.indexOf(key) > -1;\n  }\n  add(key) {\n    if (this.has(key))\n      return;\n    this.caches.push(key);\n    if (this.caches.length > this.options.max) {\n      this.free();\n    }\n  }\n  free() {\n    this.caches.shift();\n  }\n}\nexport {\n  ImageCache,\n  getBestSelectionFromSrcset,\n  getDPR,\n  hasIntersectionObserver,\n  loadImageAsync,\n  modeType,\n  off,\n  on,\n  remove,\n  supportWebp,\n  throttle\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}