{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { defineComponent } from \"vue\";\nimport { FORM_KEY, truthProp, numericProp, preventDefault, createNamespace } from \"../utils/index.mjs\";\nimport { useChildren } from \"@vant/use\";\nimport { useExpose } from \"../composables/use-expose.mjs\";\nconst [name, bem] = createNamespace(\"form\");\nconst formProps = {\n  colon: Boolean,\n  disabled: Boolean,\n  readonly: Boolean,\n  showError: Boolean,\n  labelWidth: numericProp,\n  labelAlign: String,\n  inputAlign: String,\n  scrollToError: Boolean,\n  validateFirst: Boolean,\n  submitOnEnter: truthProp,\n  showErrorMessage: truthProp,\n  errorMessageAlign: String,\n  validateTrigger: {\n    type: [String, Array],\n    default: \"onBlur\"\n  }\n};\nvar stdin_default = defineComponent({\n  name,\n  props: formProps,\n  emits: [\"submit\", \"failed\"],\n\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const {\n      children,\n      linkChildren\n    } = useChildren(FORM_KEY);\n\n    const getFieldsByNames = names => {\n      if (names) {\n        return children.filter(field => names.includes(field.name));\n      }\n\n      return children;\n    };\n\n    const validateSeq = names => new Promise((resolve, reject) => {\n      const errors = [];\n      const fields = getFieldsByNames(names);\n      fields.reduce((promise, field) => promise.then(() => {\n        if (!errors.length) {\n          return field.validate().then(error => {\n            if (error) {\n              errors.push(error);\n            }\n          });\n        }\n      }), Promise.resolve()).then(() => {\n        if (errors.length) {\n          reject(errors);\n        } else {\n          resolve();\n        }\n      });\n    });\n\n    const validateAll = names => new Promise((resolve, reject) => {\n      const fields = getFieldsByNames(names);\n      Promise.all(fields.map(item => item.validate())).then(errors => {\n        errors = errors.filter(Boolean);\n\n        if (errors.length) {\n          reject(errors);\n        } else {\n          resolve();\n        }\n      });\n    });\n\n    const validateField = name2 => {\n      const matched = children.find(item => item.name === name2);\n\n      if (matched) {\n        return new Promise((resolve, reject) => {\n          matched.validate().then(error => {\n            if (error) {\n              reject(error);\n            } else {\n              resolve();\n            }\n          });\n        });\n      }\n\n      return Promise.reject();\n    };\n\n    const validate = name2 => {\n      if (typeof name2 === \"string\") {\n        return validateField(name2);\n      }\n\n      return props.validateFirst ? validateSeq(name2) : validateAll(name2);\n    };\n\n    const resetValidation = name2 => {\n      if (typeof name2 === \"string\") {\n        name2 = [name2];\n      }\n\n      const fields = getFieldsByNames(name2);\n      fields.forEach(item => {\n        item.resetValidation();\n      });\n    };\n\n    const getValidationStatus = () => children.reduce((form, field) => {\n      form[field.name] = field.getValidationStatus();\n      return form;\n    }, {});\n\n    const scrollToField = (name2, options) => {\n      children.some(item => {\n        if (item.name === name2) {\n          item.$el.scrollIntoView(options);\n          return true;\n        }\n\n        return false;\n      });\n    };\n\n    const getValues = () => children.reduce((form, field) => {\n      form[field.name] = field.formValue.value;\n      return form;\n    }, {});\n\n    const submit = () => {\n      const values = getValues();\n      validate().then(() => emit(\"submit\", values)).catch(errors => {\n        emit(\"failed\", {\n          values,\n          errors\n        });\n\n        if (props.scrollToError && errors[0].name) {\n          scrollToField(errors[0].name);\n        }\n      });\n    };\n\n    const onSubmit = event => {\n      preventDefault(event);\n      submit();\n    };\n\n    linkChildren({\n      props\n    });\n    useExpose({\n      submit,\n      validate,\n      getValues,\n      scrollToField,\n      resetValidation,\n      getValidationStatus\n    });\n    return () => {\n      var _a;\n\n      return _createVNode(\"form\", {\n        \"class\": bem(),\n        \"onSubmit\": onSubmit\n      }, [(_a = slots.default) == null ? void 0 : _a.call(slots)]);\n    };\n  }\n\n});\nexport { stdin_default as default };","map":{"version":3,"names":["createVNode","_createVNode","defineComponent","FORM_KEY","truthProp","numericProp","preventDefault","createNamespace","useChildren","useExpose","name","bem","formProps","colon","Boolean","disabled","readonly","showError","labelWidth","labelAlign","String","inputAlign","scrollToError","validateFirst","submitOnEnter","showErrorMessage","errorMessageAlign","validateTrigger","type","Array","default","stdin_default","props","emits","setup","emit","slots","children","linkChildren","getFieldsByNames","names","filter","field","includes","validateSeq","Promise","resolve","reject","errors","fields","reduce","promise","then","length","validate","error","push","validateAll","all","map","item","validateField","name2","matched","find","resetValidation","forEach","getValidationStatus","form","scrollToField","options","some","$el","scrollIntoView","getValues","formValue","value","submit","values","catch","onSubmit","event","_a","call"],"sources":["D:/web/my-blog/node_modules/vant/es/form/Form.mjs"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { defineComponent } from \"vue\";\nimport { FORM_KEY, truthProp, numericProp, preventDefault, createNamespace } from \"../utils/index.mjs\";\nimport { useChildren } from \"@vant/use\";\nimport { useExpose } from \"../composables/use-expose.mjs\";\nconst [name, bem] = createNamespace(\"form\");\nconst formProps = {\n  colon: Boolean,\n  disabled: Boolean,\n  readonly: Boolean,\n  showError: Boolean,\n  labelWidth: numericProp,\n  labelAlign: String,\n  inputAlign: String,\n  scrollToError: Boolean,\n  validateFirst: Boolean,\n  submitOnEnter: truthProp,\n  showErrorMessage: truthProp,\n  errorMessageAlign: String,\n  validateTrigger: {\n    type: [String, Array],\n    default: \"onBlur\"\n  }\n};\nvar stdin_default = defineComponent({\n  name,\n  props: formProps,\n  emits: [\"submit\", \"failed\"],\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const {\n      children,\n      linkChildren\n    } = useChildren(FORM_KEY);\n    const getFieldsByNames = (names) => {\n      if (names) {\n        return children.filter((field) => names.includes(field.name));\n      }\n      return children;\n    };\n    const validateSeq = (names) => new Promise((resolve, reject) => {\n      const errors = [];\n      const fields = getFieldsByNames(names);\n      fields.reduce((promise, field) => promise.then(() => {\n        if (!errors.length) {\n          return field.validate().then((error) => {\n            if (error) {\n              errors.push(error);\n            }\n          });\n        }\n      }), Promise.resolve()).then(() => {\n        if (errors.length) {\n          reject(errors);\n        } else {\n          resolve();\n        }\n      });\n    });\n    const validateAll = (names) => new Promise((resolve, reject) => {\n      const fields = getFieldsByNames(names);\n      Promise.all(fields.map((item) => item.validate())).then((errors) => {\n        errors = errors.filter(Boolean);\n        if (errors.length) {\n          reject(errors);\n        } else {\n          resolve();\n        }\n      });\n    });\n    const validateField = (name2) => {\n      const matched = children.find((item) => item.name === name2);\n      if (matched) {\n        return new Promise((resolve, reject) => {\n          matched.validate().then((error) => {\n            if (error) {\n              reject(error);\n            } else {\n              resolve();\n            }\n          });\n        });\n      }\n      return Promise.reject();\n    };\n    const validate = (name2) => {\n      if (typeof name2 === \"string\") {\n        return validateField(name2);\n      }\n      return props.validateFirst ? validateSeq(name2) : validateAll(name2);\n    };\n    const resetValidation = (name2) => {\n      if (typeof name2 === \"string\") {\n        name2 = [name2];\n      }\n      const fields = getFieldsByNames(name2);\n      fields.forEach((item) => {\n        item.resetValidation();\n      });\n    };\n    const getValidationStatus = () => children.reduce((form, field) => {\n      form[field.name] = field.getValidationStatus();\n      return form;\n    }, {});\n    const scrollToField = (name2, options) => {\n      children.some((item) => {\n        if (item.name === name2) {\n          item.$el.scrollIntoView(options);\n          return true;\n        }\n        return false;\n      });\n    };\n    const getValues = () => children.reduce((form, field) => {\n      form[field.name] = field.formValue.value;\n      return form;\n    }, {});\n    const submit = () => {\n      const values = getValues();\n      validate().then(() => emit(\"submit\", values)).catch((errors) => {\n        emit(\"failed\", {\n          values,\n          errors\n        });\n        if (props.scrollToError && errors[0].name) {\n          scrollToField(errors[0].name);\n        }\n      });\n    };\n    const onSubmit = (event) => {\n      preventDefault(event);\n      submit();\n    };\n    linkChildren({\n      props\n    });\n    useExpose({\n      submit,\n      validate,\n      getValues,\n      scrollToField,\n      resetValidation,\n      getValidationStatus\n    });\n    return () => {\n      var _a;\n      return _createVNode(\"form\", {\n        \"class\": bem(),\n        \"onSubmit\": onSubmit\n      }, [(_a = slots.default) == null ? void 0 : _a.call(slots)]);\n    };\n  }\n});\nexport {\n  stdin_default as default\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}