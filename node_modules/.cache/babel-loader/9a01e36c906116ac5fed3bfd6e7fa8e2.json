{"ast":null,"code":"import { createVNode as _createVNode } from \"vue\";\nimport { ref, reactive, computed, defineComponent } from \"vue\";\nimport { clamp, isDef, numericProp, preventDefault, callInterceptor, createNamespace, makeNumericProp } from \"../utils/index.mjs\";\nimport { useRect, useClickAway } from \"@vant/use\";\nimport { useTouch } from \"../composables/use-touch.mjs\";\nimport { useExpose } from \"../composables/use-expose.mjs\";\nconst [name, bem] = createNamespace(\"swipe-cell\");\nconst swipeCellProps = {\n  name: makeNumericProp(\"\"),\n  disabled: Boolean,\n  leftWidth: numericProp,\n  rightWidth: numericProp,\n  beforeClose: Function,\n  stopPropagation: Boolean\n};\nvar stdin_default = defineComponent({\n  name,\n  props: swipeCellProps,\n  emits: [\"open\", \"close\", \"click\"],\n\n  setup(props, {\n    emit,\n    slots\n  }) {\n    let opened;\n    let lockClick;\n    let startOffset;\n    const root = ref();\n    const leftRef = ref();\n    const rightRef = ref();\n    const state = reactive({\n      offset: 0,\n      dragging: false\n    });\n    const touch = useTouch();\n\n    const getWidthByRef = ref2 => ref2.value ? useRect(ref2).width : 0;\n\n    const leftWidth = computed(() => isDef(props.leftWidth) ? +props.leftWidth : getWidthByRef(leftRef));\n    const rightWidth = computed(() => isDef(props.rightWidth) ? +props.rightWidth : getWidthByRef(rightRef));\n\n    const open = side => {\n      state.offset = side === \"left\" ? leftWidth.value : -rightWidth.value;\n\n      if (!opened) {\n        opened = true;\n        emit(\"open\", {\n          name: props.name,\n          position: side\n        });\n      }\n    };\n\n    const close = position => {\n      state.offset = 0;\n\n      if (opened) {\n        opened = false;\n        emit(\"close\", {\n          name: props.name,\n          position\n        });\n      }\n    };\n\n    const toggle = side => {\n      const offset = Math.abs(state.offset);\n      const THRESHOLD = 0.15;\n      const threshold = opened ? 1 - THRESHOLD : THRESHOLD;\n      const width = side === \"left\" ? leftWidth.value : rightWidth.value;\n\n      if (width && offset > width * threshold) {\n        open(side);\n      } else {\n        close(side);\n      }\n    };\n\n    const onTouchStart = event => {\n      if (!props.disabled) {\n        startOffset = state.offset;\n        touch.start(event);\n      }\n    };\n\n    const onTouchMove = event => {\n      if (props.disabled) {\n        return;\n      }\n\n      const {\n        deltaX\n      } = touch;\n      touch.move(event);\n\n      if (touch.isHorizontal()) {\n        lockClick = true;\n        state.dragging = true;\n        const isEdge = !opened || deltaX.value * startOffset < 0;\n\n        if (isEdge) {\n          preventDefault(event, props.stopPropagation);\n        }\n\n        state.offset = clamp(deltaX.value + startOffset, -rightWidth.value, leftWidth.value);\n      }\n    };\n\n    const onTouchEnd = () => {\n      if (state.dragging) {\n        state.dragging = false;\n        toggle(state.offset > 0 ? \"left\" : \"right\");\n        setTimeout(() => {\n          lockClick = false;\n        }, 0);\n      }\n    };\n\n    const onClick = (position = \"outside\") => {\n      emit(\"click\", position);\n\n      if (opened && !lockClick) {\n        callInterceptor(props.beforeClose, {\n          args: [{\n            name: props.name,\n            position\n          }],\n          done: () => close(position)\n        });\n      }\n    };\n\n    const getClickHandler = (position, stop) => event => {\n      if (stop) {\n        event.stopPropagation();\n      }\n\n      onClick(position);\n    };\n\n    const renderSideContent = (side, ref2) => {\n      const contentSlot = slots[side];\n\n      if (contentSlot) {\n        return _createVNode(\"div\", {\n          \"ref\": ref2,\n          \"class\": bem(side),\n          \"onClick\": getClickHandler(side, true)\n        }, [contentSlot()]);\n      }\n    };\n\n    useExpose({\n      open,\n      close\n    });\n    useClickAway(root, () => onClick(\"outside\"), {\n      eventName: \"touchstart\"\n    });\n    return () => {\n      var _a;\n\n      const wrapperStyle = {\n        transform: `translate3d(${state.offset}px, 0, 0)`,\n        transitionDuration: state.dragging ? \"0s\" : \".6s\"\n      };\n      return _createVNode(\"div\", {\n        \"ref\": root,\n        \"class\": bem(),\n        \"onClick\": getClickHandler(\"cell\", lockClick),\n        \"onTouchstart\": onTouchStart,\n        \"onTouchmove\": onTouchMove,\n        \"onTouchend\": onTouchEnd,\n        \"onTouchcancel\": onTouchEnd\n      }, [_createVNode(\"div\", {\n        \"class\": bem(\"wrapper\"),\n        \"style\": wrapperStyle\n      }, [renderSideContent(\"left\", leftRef), (_a = slots.default) == null ? void 0 : _a.call(slots), renderSideContent(\"right\", rightRef)])]);\n    };\n  }\n\n});\nexport { stdin_default as default };","map":{"version":3,"names":["createVNode","_createVNode","ref","reactive","computed","defineComponent","clamp","isDef","numericProp","preventDefault","callInterceptor","createNamespace","makeNumericProp","useRect","useClickAway","useTouch","useExpose","name","bem","swipeCellProps","disabled","Boolean","leftWidth","rightWidth","beforeClose","Function","stopPropagation","stdin_default","props","emits","setup","emit","slots","opened","lockClick","startOffset","root","leftRef","rightRef","state","offset","dragging","touch","getWidthByRef","ref2","value","width","open","side","position","close","toggle","Math","abs","THRESHOLD","threshold","onTouchStart","event","start","onTouchMove","deltaX","move","isHorizontal","isEdge","onTouchEnd","setTimeout","onClick","args","done","getClickHandler","stop","renderSideContent","contentSlot","eventName","_a","wrapperStyle","transform","transitionDuration","default","call"],"sources":["D:/web/my-blog/node_modules/vant/es/swipe-cell/SwipeCell.mjs"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { ref, reactive, computed, defineComponent } from \"vue\";\nimport { clamp, isDef, numericProp, preventDefault, callInterceptor, createNamespace, makeNumericProp } from \"../utils/index.mjs\";\nimport { useRect, useClickAway } from \"@vant/use\";\nimport { useTouch } from \"../composables/use-touch.mjs\";\nimport { useExpose } from \"../composables/use-expose.mjs\";\nconst [name, bem] = createNamespace(\"swipe-cell\");\nconst swipeCellProps = {\n  name: makeNumericProp(\"\"),\n  disabled: Boolean,\n  leftWidth: numericProp,\n  rightWidth: numericProp,\n  beforeClose: Function,\n  stopPropagation: Boolean\n};\nvar stdin_default = defineComponent({\n  name,\n  props: swipeCellProps,\n  emits: [\"open\", \"close\", \"click\"],\n  setup(props, {\n    emit,\n    slots\n  }) {\n    let opened;\n    let lockClick;\n    let startOffset;\n    const root = ref();\n    const leftRef = ref();\n    const rightRef = ref();\n    const state = reactive({\n      offset: 0,\n      dragging: false\n    });\n    const touch = useTouch();\n    const getWidthByRef = (ref2) => ref2.value ? useRect(ref2).width : 0;\n    const leftWidth = computed(() => isDef(props.leftWidth) ? +props.leftWidth : getWidthByRef(leftRef));\n    const rightWidth = computed(() => isDef(props.rightWidth) ? +props.rightWidth : getWidthByRef(rightRef));\n    const open = (side) => {\n      state.offset = side === \"left\" ? leftWidth.value : -rightWidth.value;\n      if (!opened) {\n        opened = true;\n        emit(\"open\", {\n          name: props.name,\n          position: side\n        });\n      }\n    };\n    const close = (position) => {\n      state.offset = 0;\n      if (opened) {\n        opened = false;\n        emit(\"close\", {\n          name: props.name,\n          position\n        });\n      }\n    };\n    const toggle = (side) => {\n      const offset = Math.abs(state.offset);\n      const THRESHOLD = 0.15;\n      const threshold = opened ? 1 - THRESHOLD : THRESHOLD;\n      const width = side === \"left\" ? leftWidth.value : rightWidth.value;\n      if (width && offset > width * threshold) {\n        open(side);\n      } else {\n        close(side);\n      }\n    };\n    const onTouchStart = (event) => {\n      if (!props.disabled) {\n        startOffset = state.offset;\n        touch.start(event);\n      }\n    };\n    const onTouchMove = (event) => {\n      if (props.disabled) {\n        return;\n      }\n      const {\n        deltaX\n      } = touch;\n      touch.move(event);\n      if (touch.isHorizontal()) {\n        lockClick = true;\n        state.dragging = true;\n        const isEdge = !opened || deltaX.value * startOffset < 0;\n        if (isEdge) {\n          preventDefault(event, props.stopPropagation);\n        }\n        state.offset = clamp(deltaX.value + startOffset, -rightWidth.value, leftWidth.value);\n      }\n    };\n    const onTouchEnd = () => {\n      if (state.dragging) {\n        state.dragging = false;\n        toggle(state.offset > 0 ? \"left\" : \"right\");\n        setTimeout(() => {\n          lockClick = false;\n        }, 0);\n      }\n    };\n    const onClick = (position = \"outside\") => {\n      emit(\"click\", position);\n      if (opened && !lockClick) {\n        callInterceptor(props.beforeClose, {\n          args: [{\n            name: props.name,\n            position\n          }],\n          done: () => close(position)\n        });\n      }\n    };\n    const getClickHandler = (position, stop) => (event) => {\n      if (stop) {\n        event.stopPropagation();\n      }\n      onClick(position);\n    };\n    const renderSideContent = (side, ref2) => {\n      const contentSlot = slots[side];\n      if (contentSlot) {\n        return _createVNode(\"div\", {\n          \"ref\": ref2,\n          \"class\": bem(side),\n          \"onClick\": getClickHandler(side, true)\n        }, [contentSlot()]);\n      }\n    };\n    useExpose({\n      open,\n      close\n    });\n    useClickAway(root, () => onClick(\"outside\"), {\n      eventName: \"touchstart\"\n    });\n    return () => {\n      var _a;\n      const wrapperStyle = {\n        transform: `translate3d(${state.offset}px, 0, 0)`,\n        transitionDuration: state.dragging ? \"0s\" : \".6s\"\n      };\n      return _createVNode(\"div\", {\n        \"ref\": root,\n        \"class\": bem(),\n        \"onClick\": getClickHandler(\"cell\", lockClick),\n        \"onTouchstart\": onTouchStart,\n        \"onTouchmove\": onTouchMove,\n        \"onTouchend\": onTouchEnd,\n        \"onTouchcancel\": onTouchEnd\n      }, [_createVNode(\"div\", {\n        \"class\": bem(\"wrapper\"),\n        \"style\": wrapperStyle\n      }, [renderSideContent(\"left\", leftRef), (_a = slots.default) == null ? void 0 : _a.call(slots), renderSideContent(\"right\", rightRef)])]);\n    };\n  }\n});\nexport {\n  stdin_default as default\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}